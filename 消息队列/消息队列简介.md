# 消息队列简介

## 消息队列是什么

消息队列，即用来保存、传送消息的容器

## 消息队列的优点

消息队列主要有三大作用

### 解耦

假如初始状态下，A要生产一个消息，发送给B和C，可以耦合地让A直接传给B和C。但是随着架构的更改，多了一个D也要获取A的消息，又或者C不再需要A的消息，这样修改起来就非常麻烦。如果引入消息队列，那么就可以让A把消息统一传给消息队列，需要获取消息的BCD只从消息队列中获取消息，如果哪个模块不需要这个消息了，就不从这个消息队列中获取消息即可。这样实现了系统间的解耦

### 异步

比如一个注册流程，可以分为以下几步：用户提交表单->后台获取表单->写入数据库->发送验证邮件->反馈注册结果。这一套下来，往往会花费比较长的时间，如果引入消息队列，让写入数据库和发送邮件异步进行，用户尽快得到反馈结果，那么就可以提升响应速度

### 削峰

比如在一个高峰期，一秒有10W条请求，但是服务器一秒最多处理1W条请求，如果强行处理10W条可能会导致宕机。这时候可以让消息队列缓存请求，将请求以每秒1W条的速度传给服务器，从而达到削峰效果

## 消息队列的缺点

虽然消息队列有一堆好处，但也有一些缺点

### 系统可用性降低

在加入MQ之后，我们需要考虑MQ宕机等情况

### 系统复杂性提高

MQ可能导致消息丢失、消息被重复消费、消息顺序错乱等问题