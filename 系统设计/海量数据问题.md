# 海量数据问题

## 一、排序

### 1、问题

假如有一个**1G**大小的文件，文件里每一行是一个单词，要求按照字典序对单词进行排序。内存大小限制是**128M**

### 2、解决方案

利用多路归并排序的方法对大文件进行排序，即

先把1G的大文件，根据内存大小分为足够小的几个小文件。根据题意，可以分为1G/128M=8个小文件。然后分别对8个小文件通过快排进行排序，最后利用归并排序的思路，遍历每个小文件首部的单词（即字典序最靠前的单词），并放入结果文件中保存

## 二、求出现频率最大的k个

### 1、问题

假如有一个**1G**大小的文件，文件里每一行是一个单词，要求返回出现频率最高的100个词。内存大小限制是**128M**

### 2、解决方案1

首先要把大文件拆分为多个小文件，假设小文件的数量为n，拆分规则可以用单词哈希值与n进行模除，这样做的目的在于把相同的单词都分到同一个文件中。然后对每个文件分别利用HashMap计数，取出现频率前100的单词，然后这n个前100的单词再做一次比较

### 3、解决方案2

方案1的问题在于，可能由于哈希冲突的原因，很多单词被分到了同一个小文件中，那么内存容量可能不足以维护一个HashMap

仍然可以利用多路排序的思路，将大文件按照大小拆分为足够小的文件，然后分别进行排序。再用一个大顶堆维护出现频率前100的单词