# 秒杀系统设计

## 一、前端

### 1、避免重复点击

可以将在用户点击后的一段时间内将按钮置为不可用

### 2、资源静态化

提前将静态资源放入cdn，降低前端服务器的压力

## 二、网关

### 1、负载均衡

通过nginx将请求分发到不同的服务器

## 三、后端

### 1、拦截用户重复请求

可以通过redis存储用户购买记录，通过限售的方式拒绝用户的重复请求

也可以限制用户请求的频率，可以借助sentinel实现

### 2、利用mq削峰

## 四、存储

### 1、添加缓存

在redis中存储商品信息和库存

### 2、防止超卖

所有的lua脚本在redis实例中共用同一个lua解释器，某一个lua脚本在被执行的时候，其他lua脚本无法执行，所以lua可以保证redis的原子性

所以可以通过lua脚本检验redis中的库存容量，如果大于0再执行售卖操作